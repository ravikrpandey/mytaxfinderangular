"use strict";(self.webpackChunkmytaxfinder=self.webpackChunkmytaxfinder||[]).push([[170],{7170:(z,g,a)=>{a.r(g),a.d(g,{QueriesModule:()=>B});var m=a(177),u=a(4147),e=a(4438),h=a(8709),_=a(2341);let v=(()=>{class t{constructor(){this.queryData=null}setQueryData(i){this.queryData=i}getQueryData(){return this.queryData}clearQueryData(){this.queryData=null}static#e=this.\u0275fac=function(r){return new(r||t)};static#i=this.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var C=a(9641);let b=(()=>{class t{constructor(i,r,n,l,p){this.commonService=i,this.snackBar=r,this.cdr=n,this.router=l,this.sharedService=p,this.message="Please fill in all the required fields.",this.rowData=[],this.columnDefs=[{headerName:"ID",field:"id"},{headerName:"First Name",field:"firstName"},{headerName:"Last Name",field:"lastName"},{headerName:"Service Type",field:"serviceType"},{headerName:"Email",field:"email"},{headerName:"Contact",field:"contact"},{headerName:"Status",field:"status"},{headerName:"Application Status",field:"application_status"},{headerName:"Ref Number",field:"ref_number"},{headerName:"Created At",field:"createdAt"},{headerName:"Updated At",field:"updatedAt"},{headerName:"Uploaded Files",field:"files"},{headerName:"Actions",field:"actions",width:150,cellRenderer:c=>{const f=document.createElement("button");return f.innerHTML='<i class="material-icons" style="cursor: pointer;">edit</i>',f.style.background="none",f.style.border="none",f.style.cursor="pointer",f.addEventListener("click",()=>{this.onEditRow(c.data)}),f}}],this.gridOptions={enableRangeSelection:!0,enableClipboard:!0,clipboardDelimiter:"\t",suppressClipboardPaste:!0}}ngOnInit(){this.fetchData()}fetchData(){this.commonService.litEnquiry().subscribe({next:i=>{i.success?(this.rowData=i.data,this.cdr.detectChanges(),this.showSuccessNotification(i.message)):this.showErrorNotification("Failed to load data.")},error:()=>{this.showErrorNotification("An error occurred while fetching data.")}})}onEditRow(i){this.sharedService.setQueryData(i),this.router.navigate(["/admin/queries/edit-filed-queries"],{state:{queryData:i}}),console.log("Edit row data:",i)}onGridReady(i){this.gridApi=i.api,this.gridColumnApi=i.columnApi,console.log("Grid API initialized:",this.gridApi),this.gridApi.setRowData(this.rowData)}onSearchChanged(i){this.gridApi?this.gridApi.setQuickFilter(i.target.value):console.error("Grid API is not initialized yet")}showSuccessNotification(i){this.snackBar.open(i,"Close",{duration:2e3,panelClass:["snackbar-success"]})}showErrorNotification(i){this.snackBar.open(i,"Close",{duration:3e3,panelClass:["snackbar-error"]})}static#e=this.\u0275fac=function(r){return new(r||t)(e.rXU(h.h),e.rXU(_.UG),e.rXU(e.gRc),e.rXU(u.Ix),e.rXU(v))};static#i=this.\u0275cmp=e.VBU({type:t,selectors:[["app-filed-queries"]],decls:7,vars:5,consts:[["agGrid",""],[1,"query-header"],[1,"search-container"],["type","text","placeholder","Search...","aria-label","Search Queries",1,"search-input",3,"input"],[1,"ag-theme-alpine",2,"width","100%","height","500px",3,"gridReady","columnDefs","rowData","gridOptions","pagination","paginationPageSize"]],template:function(r,n){if(1&r){const l=e.RV6();e.j41(0,"div",1)(1,"h2"),e.EFF(2,"Query Filed List"),e.k0s()(),e.j41(3,"div",2)(4,"input",3),e.bIt("input",function(c){return e.eBV(l),e.Njj(n.onSearchChanged(c))}),e.k0s()(),e.j41(5,"ag-grid-angular",4,0),e.bIt("gridReady",function(c){return e.eBV(l),e.Njj(n.onGridReady(c))}),e.k0s()}2&r&&(e.R7$(5),e.Y8G("columnDefs",n.columnDefs)("rowData",n.rowData)("gridOptions",n.gridOptions)("pagination",!0)("paginationPageSize",20))},dependencies:[C.xs],styles:[".ag-theme-alpine[_ngcontent-%COMP%]{--ag-background-color: #f8f9fa;--ag-header-background-color: #163865;--ag-header-foreground-color: white;--ag-font-size: 14px}.query-header[_ngcontent-%COMP%]{text-align:left;margin-bottom:10px}.query-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;color:#163865;font-weight:700}.search-container[_ngcontent-%COMP%]{margin:15px 0;text-align:right;padding:0 20px}.search-input[_ngcontent-%COMP%]{width:250px;padding:10px;font-size:14px;border:2px solid #163865;border-radius:5px;outline:none;transition:border-color .3s ease}.search-input[_ngcontent-%COMP%]:focus{border-color:#00b0ff}"]})}return t})();var s=a(9417);const d=t=>({"is-invalid":t});function F(t,o){1&t&&(e.j41(0,"div"),e.EFF(1,"First Name is required"),e.k0s())}function x(t,o){if(1&t&&(e.j41(0,"div",26),e.DNE(1,F,2,0,"div",27),e.k0s()),2&t){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.f.firstName.errors?null:i.f.firstName.errors.required)}}function N(t,o){1&t&&(e.j41(0,"div"),e.EFF(1,"Last Name is required"),e.k0s())}function P(t,o){if(1&t&&(e.j41(0,"div",26),e.DNE(1,N,2,0,"div",27),e.k0s()),2&t){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.f.lastName.errors?null:i.f.lastName.errors.required)}}function y(t,o){1&t&&(e.j41(0,"div"),e.EFF(1,"Service Type is required"),e.k0s())}function E(t,o){if(1&t&&(e.j41(0,"div",26),e.DNE(1,y,2,0,"div",27),e.k0s()),2&t){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.f.serviceType.errors?null:i.f.serviceType.errors.required)}}function O(t,o){1&t&&(e.j41(0,"div"),e.EFF(1,"Ref_number is required"),e.k0s())}function k(t,o){if(1&t&&(e.j41(0,"div",26),e.DNE(1,O,2,0,"div",27),e.k0s()),2&t){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.f.ref_number.errors?null:i.f.ref_number.errors.required)}}function M(t,o){1&t&&(e.j41(0,"div"),e.EFF(1,"Email is required"),e.k0s())}function w(t,o){1&t&&(e.j41(0,"div"),e.EFF(1,"Invalid email address"),e.k0s())}function G(t,o){if(1&t&&(e.j41(0,"div",26),e.DNE(1,M,2,0,"div",27)(2,w,2,0,"div",27),e.k0s()),2&t){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.f.email.errors?null:i.f.email.errors.required),e.R7$(),e.Y8G("ngIf",null==i.f.email.errors?null:i.f.email.errors.email)}}function j(t,o){1&t&&(e.j41(0,"div"),e.EFF(1,"Contact is required"),e.k0s())}function D(t,o){if(1&t&&(e.j41(0,"div",26),e.DNE(1,j,2,0,"div",27),e.k0s()),2&t){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.f.contact.errors?null:i.f.contact.errors.required)}}function I(t,o){1&t&&(e.j41(0,"div"),e.EFF(1,"Status is required"),e.k0s())}function R(t,o){if(1&t&&(e.j41(0,"div",26),e.DNE(1,I,2,0,"div",27),e.k0s()),2&t){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.f.status.errors?null:i.f.status.errors.required)}}function q(t,o){1&t&&(e.j41(0,"div"),e.EFF(1,"application_status is required"),e.k0s())}function T(t,o){if(1&t&&(e.j41(0,"div",26),e.DNE(1,q,2,0,"div",27),e.k0s()),2&t){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.f.application_status.errors?null:i.f.application_status.errors.required)}}function $(t,o){if(1&t){const i=e.RV6();e.j41(0,"img",31),e.bIt("mouseover",function(){e.eBV(i);const n=e.XpG().$implicit,l=e.XpG();return e.Njj(l.showPreview(n))})("mouseout",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.hidePreview())}),e.k0s()}if(2&t){const i=e.XpG().$implicit;e.Y8G("src",i,e.B4B)}}function Q(t,o){if(1&t&&(e.j41(0,"a",32),e.nrm(1,"i",33),e.k0s()),2&t){const i=e.XpG().$implicit,r=e.XpG();e.Y8G("href",i,e.B4B),e.R7$(),e.Y8G("ngClass",r.getDocumentIcon(i))}}function Y(t,o){if(1&t&&(e.j41(0,"div",28),e.DNE(1,$,1,1,"img",29)(2,Q,2,2,"a",30),e.k0s()),2&t){const i=o.$implicit,r=e.XpG();e.R7$(),e.Y8G("ngIf",r.isImage(i)),e.R7$(),e.Y8G("ngIf",r.isDocument(i))}}function S(t,o){if(1&t&&(e.j41(0,"div",34),e.nrm(1,"img",35),e.k0s()),2&t){const i=e.XpG();e.R7$(),e.Y8G("src",i.previewFile,e.B4B)}}const X=[{path:"",component:b},{path:"list-filed",component:b},{path:"edit-filed-queries",component:(()=>{class t{constructor(i,r,n,l,p,c){this.fb=i,this.commonService=r,this.route=n,this.router=l,this.sharedService=p,this.snackBar=c,this.uploadedFiles=[],this.selectedFile=null,this.previewFile=null}ngOnInit(){this.queryId=this.route.snapshot.params.id;const i=this.sharedService.getQueryData();i?(this.initializeForm(i),this.uploadedFiles=Array.isArray(i.files)?i.files:Object.values(i.files)):(console.error("No data received for editing"),this.router.navigate(["/queries"]))}initializeForm(i){this.editForm=this.fb.group({firstName:[i.firstName,[s.k0.required]],lastName:[i.lastName,[s.k0.required]],serviceType:[i.serviceType,[s.k0.required]],email:[i.email,[s.k0.required,s.k0.email]],contact:[i.contact,[s.k0.required]],status:[i.status,[s.k0.required]],application_status:[i.application_status,[s.k0.required]],ref_number:[i.ref_number,[s.k0.required]]})}isImage(i){return null!==i.match(/\.(jpeg|jpg|png)$/i)}isDocument(i){return null!==i.match(/\.(pdf|docx|doc)$/i)}getDocumentIcon(i){return i.match(/\.pdf$/i)?"fa-file-pdf":i.match(/\.docx$/i)||i.match(/\.doc$/i)?"fa-file-word":"fa-file"}showPreview(i){this.isImage(i)&&(this.previewFile=i)}hidePreview(){this.previewFile=null}onSubmit(){this.editForm.valid&&this.commonService.updateQuery(this.queryId,this.editForm.value).subscribe(r=>{!0===r.success?(this.showSuccessNotification(r.message),setInterval(()=>{this.router.navigate(["/admin/queries/list-filed"])},5e3)):this.showErrorNotification(r.message)})}get f(){return this.editForm.controls}showSuccessNotification(i){this.snackBar.open(i,"Close",{duration:3e3,panelClass:["snackbar-success"]})}showErrorNotification(i){this.snackBar.open(i,"Close",{duration:3e3,panelClass:["snackbar-error"]})}static#e=this.\u0275fac=function(r){return new(r||t)(e.rXU(s.ok),e.rXU(h.h),e.rXU(u.nX),e.rXU(u.Ix),e.rXU(v),e.rXU(_.UG))};static#i=this.\u0275cmp=e.VBU({type:t,selectors:[["app-edit-filed-queries"]],decls:54,vars:36,consts:[[1,"edit-query-container"],[3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group","col"],["for","firstName"],["id","firstName","formControlName","firstName",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","lastName"],["id","lastName","formControlName","lastName",1,"form-control",3,"ngClass"],["for","serviceType"],["id","serviceType","formControlName","serviceType",1,"form-control",3,"ngClass"],["for","ref_number"],["id","ref_number","formControlName","ref_number","readonly","",1,"form-control",3,"ngClass"],["for","email"],["id","email","formControlName","email",1,"form-control",3,"ngClass"],["for","contact"],["id","contact","formControlName","contact",1,"form-control",3,"ngClass"],["for","status"],["id","status","formControlName","status","readonly","",1,"form-control",3,"ngClass"],["for","application_status"],["id","application_status","formControlName","application_status",1,"form-control",3,"ngClass"],[1,"uploaded-files"],[1,"file-icons"],["class","file-item",4,"ngFor","ngForOf"],["class","file-preview",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"invalid-feedback"],[4,"ngIf"],[1,"file-item"],["alt","Image file",3,"src","mouseover","mouseout",4,"ngIf"],["target","_blank",3,"href",4,"ngIf"],["alt","Image file",3,"mouseover","mouseout","src"],["target","_blank",3,"href"],[1,"fa",3,"ngClass"],[1,"file-preview"],["alt","Preview",3,"src"]],template:function(r,n){1&r&&(e.j41(0,"div",0)(1,"h2"),e.EFF(2,"Edit Filed Query"),e.k0s(),e.j41(3,"form",1),e.bIt("ngSubmit",function(){return n.onSubmit()}),e.j41(4,"div",2)(5,"div",3)(6,"label",4),e.EFF(7,"First Name"),e.k0s(),e.nrm(8,"input",5),e.DNE(9,x,2,1,"div",6),e.k0s(),e.j41(10,"div",3)(11,"label",7),e.EFF(12,"Last Name"),e.k0s(),e.nrm(13,"input",8),e.DNE(14,P,2,1,"div",6),e.k0s(),e.j41(15,"div",3)(16,"label",9),e.EFF(17,"Service Type"),e.k0s(),e.nrm(18,"input",10),e.DNE(19,E,2,1,"div",6),e.k0s(),e.j41(20,"div",3)(21,"label",11),e.EFF(22,"Ref_number"),e.k0s(),e.nrm(23,"input",12),e.DNE(24,k,2,1,"div",6),e.k0s()(),e.j41(25,"div",2)(26,"div",3)(27,"label",13),e.EFF(28,"Email"),e.k0s(),e.nrm(29,"input",14),e.DNE(30,G,3,2,"div",6),e.k0s(),e.j41(31,"div",3)(32,"label",15),e.EFF(33,"Contact"),e.k0s(),e.nrm(34,"input",16),e.DNE(35,D,2,1,"div",6),e.k0s(),e.j41(36,"div",3)(37,"label",17),e.EFF(38,"Status"),e.k0s(),e.nrm(39,"input",18),e.DNE(40,R,2,1,"div",6),e.k0s(),e.j41(41,"div",3)(42,"label",19),e.EFF(43,"Application_status"),e.k0s(),e.nrm(44,"input",20),e.DNE(45,T,2,1,"div",6),e.k0s()(),e.j41(46,"div",21)(47,"h3"),e.EFF(48,"Uploaded Files"),e.k0s(),e.j41(49,"div",22),e.DNE(50,Y,3,2,"div",23),e.k0s()(),e.DNE(51,S,2,1,"div",24),e.j41(52,"button",25),e.EFF(53,"Submit"),e.k0s()()()),2&r&&(e.R7$(3),e.Y8G("formGroup",n.editForm),e.R7$(5),e.Y8G("ngClass",e.eq3(20,d,n.f.firstName.invalid&&n.f.firstName.touched)),e.R7$(),e.Y8G("ngIf",n.f.firstName.invalid&&n.f.firstName.touched),e.R7$(4),e.Y8G("ngClass",e.eq3(22,d,n.f.lastName.invalid&&n.f.lastName.touched)),e.R7$(),e.Y8G("ngIf",n.f.lastName.invalid&&n.f.lastName.touched),e.R7$(4),e.Y8G("ngClass",e.eq3(24,d,n.f.serviceType.invalid&&n.f.serviceType.touched)),e.R7$(),e.Y8G("ngIf",n.f.serviceType.invalid&&n.f.serviceType.touched),e.R7$(4),e.Y8G("ngClass",e.eq3(26,d,n.f.ref_number.invalid&&n.f.ref_number.touched)),e.R7$(),e.Y8G("ngIf",n.f.ref_number.invalid&&n.f.ref_number.touched),e.R7$(5),e.Y8G("ngClass",e.eq3(28,d,n.f.email.invalid&&n.f.email.touched)),e.R7$(),e.Y8G("ngIf",n.f.email.invalid&&n.f.email.touched),e.R7$(4),e.Y8G("ngClass",e.eq3(30,d,n.f.contact.invalid&&n.f.contact.touched)),e.R7$(),e.Y8G("ngIf",n.f.contact.invalid&&n.f.contact.touched),e.R7$(4),e.Y8G("ngClass",e.eq3(32,d,n.f.status.invalid&&n.f.status.touched)),e.R7$(),e.Y8G("ngIf",n.f.status.invalid&&n.f.status.touched),e.R7$(4),e.Y8G("ngClass",e.eq3(34,d,n.f.application_status.invalid&&n.f.application_status.touched)),e.R7$(),e.Y8G("ngIf",n.f.application_status.invalid&&n.f.application_status.touched),e.R7$(5),e.Y8G("ngForOf",n.uploadedFiles),e.R7$(),e.Y8G("ngIf",n.previewFile&&n.isImage(n.previewFile)),e.R7$(),e.Y8G("disabled",n.editForm.invalid))},dependencies:[m.YU,m.Sq,m.bT,s.qT,s.me,s.BC,s.cb,s.j4,s.JD],styles:["h2[_ngcontent-%COMP%]{text-align:left;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px;display:flex;flex-direction:column;width:100%}.input-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:15px;flex-wrap:wrap}.input-group[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1 1 30%}input.form-control[_ngcontent-%COMP%]{width:100%;padding:8px;margin:5px 0}.is-invalid[_ngcontent-%COMP%]{border-color:red}.invalid-feedback[_ngcontent-%COMP%]{color:red;font-size:.875em}button[_ngcontent-%COMP%]{display:block;width:100%;padding:10px;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer}button[_ngcontent-%COMP%]:disabled{background-color:#ccc}.edit-query-container[_ngcontent-%COMP%]{max-width:1350px;margin:20px auto;padding:20px;background:#f9f9f9;border-radius:8px}.form-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:20px}.form-group[_ngcontent-%COMP%]{flex:1}.file-thumbnails[_ngcontent-%COMP%]{display:flex;gap:10px}.file-thumbnail[_ngcontent-%COMP%]{cursor:pointer;width:80px;height:80px;border:1px solid #ddd;border-radius:4px;overflow:hidden;display:flex;justify-content:center;align-items:center}.file-icon[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.modal[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:20px;z-index:1000;border-radius:8px;box-shadow:0 2px 10px #0003}.modal-content[_ngcontent-%COMP%]{position:relative;text-align:center}.modal-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .modal-content[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{max-width:100%;max-height:500px}.close[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;font-size:20px;cursor:pointer}.uploaded-files[_ngcontent-%COMP%]{margin-top:20px}.uploaded-files[_ngcontent-%COMP%]   .file-icons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px}.uploaded-files[_ngcontent-%COMP%]   .file-icons[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;cursor:pointer}.uploaded-files[_ngcontent-%COMP%]   .file-icons[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border:1px solid #ccc;border-radius:5px}.uploaded-files[_ngcontent-%COMP%]   .file-icons[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .fa-file-pdf[_ngcontent-%COMP%]{font-size:50px;color:#d9534f}.file-preview[_ngcontent-%COMP%]{position:absolute;top:50px;left:50%;transform:translate(-50%);z-index:1000;background:#fff;border:1px solid #ccc;box-shadow:0 4px 8px #0000001a;padding:10px;border-radius:8px}.file-preview[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{width:300px;height:400px}.file-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:300px;height:auto;border-radius:8px}.file-icons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px}.file-icons[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]{position:relative;width:50px;height:50px}.file-icons[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border:1px solid #ccc;border-radius:5px;cursor:pointer}.file-icons[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:30px;display:flex;align-items:center;justify-content:center;width:50px;height:50px;border:1px solid #ccc;border-radius:5px;background:#f1f1f1;color:#333;cursor:pointer}.file-icons[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .fa-file-pdf[_ngcontent-%COMP%]{color:#d9534f}.file-icons[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .fa-file-word[_ngcontent-%COMP%]{color:#0078d4}.file-icons[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .fa-file[_ngcontent-%COMP%]{color:#ccc}.file-preview[_ngcontent-%COMP%]{position:absolute;top:50px;left:50%;transform:translate(-50%);z-index:1000;background:#fff;border:1px solid #ccc;padding:10px;border-radius:8px}.file-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:300px;height:auto}"]})}return t})()}];let A=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#i=this.\u0275mod=e.$C({type:t});static#t=this.\u0275inj=e.G2t({imports:[u.iI.forChild(X),u.iI]})}return t})(),B=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#i=this.\u0275mod=e.$C({type:t});static#t=this.\u0275inj=e.G2t({imports:[m.MD,A,C.$V,s.X1]})}return t})()}}]);